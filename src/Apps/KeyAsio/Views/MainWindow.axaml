<suki:SukiWindow
  x:Class="KeyAsio.Views.MainWindow"
  xmlns="https://github.com/avaloniaui"
  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
  xmlns:controls="using:KeyAsio.Views.Controls"
  xmlns:converters="using:KeyAsio.Converters"
  xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
  xmlns:lang="clr-namespace:KeyAsio.Lang"
  xmlns:materialIcons="clr-namespace:Material.Icons.Avalonia;assembly=Material.Icons.Avalonia"
  xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
  xmlns:pages="using:KeyAsio.Views.Pages"
  xmlns:suki="https://github.com/kikipoulet/SukiUI"
  xmlns:vm="using:KeyAsio.ViewModels"
  Title="KeyASIO"
  Width="905"
  Height="697"
  x:DataType="vm:MainWindowViewModel"
  BackgroundAnimationEnabled="False"
  BackgroundStyle="Flat"
  BackgroundTransitionsEnabled="False"
  Icon="/Assets/KeyAsio.ico"
  Loaded="Control_OnLoaded"
  TitleBarAnimationEnabled="False"
  WindowStartupLocation="CenterScreen"
  mc:Ignorable="d">

  <suki:SukiWindow.Resources>

    <TrayIcons x:Key="TrayIcons">
      <TrayIcon
        Command="{Binding ShowMainWindowCommand}"
        Icon="/Assets/KeyAsio.ico"
        ToolTipText="KeyAsio">
        <TrayIcon.Menu>
          <NativeMenu>
            <NativeMenuItem Command="{Binding ShowMainWindowCommand}" Header="{I18N {x:Static lang:SRKeys.TrayIcon_OpenDashboard}}" />
            <NativeMenuItem
              Command="{Binding AudioSettings.OpenAsioPanelCommand}"
              Header="{I18N {x:Static lang:SRKeys.TrayIcon_OpenAsioPanel}}"
              IsVisible="{Binding AudioSettings.IsAsio}" />
            <NativeMenuItemSeparator />
            <NativeMenuItem Command="{Binding ExitApplicationCommand}" Header="{I18N {x:Static lang:SRKeys.TrayIcon_Exit}}" />
          </NativeMenu>
        </TrayIcon.Menu>
      </TrayIcon>
    </TrayIcons>

    <converters:ExtendedVolumeConverter x:Key="ExtendedVolumeConverter" />
  </suki:SukiWindow.Resources>

  <Design.DataContext>
    <!--
      This only sets the DataContext for the previewer in an IDE,
      to set the actual DataContext for runtime, set the DataContext property in code (look at App.axaml.cs)
    -->
    <vm:MainWindowViewModel />
  </Design.DataContext>

  <suki:SukiWindow.LogoContent>
    <Panel Width="24" Height="24">
      <Panel.Styles>
        <Style Selector="Button">
          <Setter Property="Transitions">
            <Setter.Value>
              <Transitions>
                <BrushTransition Property="Background" Duration="{DynamicResource ShortAnimationDuration}" />
              </Transitions>
            </Setter.Value>
          </Setter>
        </Style>
        <Style Selector="Path">
          <Setter Property="Transitions">
            <Setter.Value>
              <Transitions>
                <BrushTransition Property="Fill" Duration="{DynamicResource ShortAnimationDuration}" />
              </Transitions>
            </Setter.Value>
          </Setter>
        </Style>
      </Panel.Styles>
      <Border Background="#181C1F" CornerRadius="8" />
      <Border
        Background="{DynamicResource SukiPrimaryColor10}"
        CornerRadius="8"
        RenderOptions.BitmapBlendingMode="Screen" />
      <Border
        Margin="3"
        Background="#2A2F33"
        CornerRadius="5" />
      <Border
        Margin="3"
        Background="{DynamicResource SukiPrimaryColor10}"
        CornerRadius="5"
        RenderOptions.BitmapBlendingMode="Screen">
        <Viewbox
          Width="12"
          Height="12"
          ClipToBounds="False">
          <Panel>
            <Path
              Data="M413.589333 577.472h-150.784c-19.690667 0-33.28-19.712-26.261333-38.101333L386.346667 146.090667A28.096 28.096 0 0 1 412.586667 128h252.864c19.946667 0 33.536 20.202667 26.005333 38.677333l-87.253333 214.144h164.266666c24.149333 0 37.034667 28.48 21.098667 46.634667L386.922667 886.293333c-19.584 22.293333-55.893333 2.965333-48.277334-25.728l74.944-283.093333z"
              Fill="White"
              Stretch="Uniform" />
            <Path
              Data="M413.589333 577.472h-150.784c-19.690667 0-33.28-19.712-26.261333-38.101333L386.346667 146.090667A28.096 28.096 0 0 1 412.586667 128h252.864c19.946667 0 33.536 20.202667 26.005333 38.677333l-87.253333 214.144h164.266666c24.149333 0 37.034667 28.48 21.098667 46.634667L386.922667 886.293333c-19.584 22.293333-55.893333 2.965333-48.277334-25.728l74.944-283.093333z"
              Fill="{DynamicResource SukiPrimaryColor75}"
              RenderOptions.BitmapBlendingMode="Screen"
              Stretch="Uniform">
            </Path>
          </Panel>
        </Viewbox>
      </Border>
    </Panel>
  </suki:SukiWindow.LogoContent>

  <suki:SukiWindow.RightWindowTitleBarControls>
    <Button
      Padding="0"
      Classes="Basic"
      Command="{Binding UpdateService.TriggerUpdateCommand}"
      IsVisible="{Binding UpdateService.NewRelease, Converter={x:Static StringConverters.IsNotNullOrEmpty}}"
      ToolTip.Tip="{I18N {x:Static lang:SRKeys.MainWindow_ClickToUpdate}}">
      <StackPanel Orientation="Horizontal" Spacing="5">
        <materialIcons:MaterialIcon Kind="Update" />
        <TextBlock
          VerticalAlignment="Center"
          FontSize="12"
          Text="{I18N {x:Static lang:SRKeys.MainWindow_ClickToUpdate}}" />
      </StackPanel>
    </Button>
  </suki:SukiWindow.RightWindowTitleBarControls>

  <suki:SukiWindow.Hosts>
    <suki:SukiToastHost Name="ToastHost" Position="BottomLeft" />
    <suki:SukiDialogHost Manager="{Binding DialogManager}" />
  </suki:SukiWindow.Hosts>

  <suki:SukiSideMenu
    IsSearchEnabled="False"
    IsSelectedItemContentMovable="False"
    IsToggleButtonVisible="True"
    SelectedItem="{Binding SelectedMenuItem}">
    <suki:SukiSideMenu.Items>

      <!--  PAGE 1: DASHBOARD  -->
      <suki:SukiSideMenuItem Classes="Compact" Header="{I18N {x:Static lang:SRKeys.Page_Dashboard}}">
        <suki:SukiSideMenuItem.Icon>
          <materialIcons:MaterialIcon Kind="ViewDashboard" />
        </suki:SukiSideMenuItem.Icon>
        <suki:SukiSideMenuItem.PageContent>
          <pages:DashboardPage />
        </suki:SukiSideMenuItem.PageContent>
      </suki:SukiSideMenuItem>

      <!--  PAGE 2: SYNC MODE  -->
      <suki:SukiSideMenuItem Classes="Compact" Header="{I18N {x:Static lang:SRKeys.Page_SyncMode}}">
        <suki:SukiSideMenuItem.Icon>
          <materialIcons:MaterialIcon Kind="Link" />
        </suki:SukiSideMenuItem.Icon>
        <suki:SukiSideMenuItem.PageContent>
          <pages:SyncModePage />
        </suki:SukiSideMenuItem.PageContent>
      </suki:SukiSideMenuItem>

      <!--  PAGE 3: AUDIO ENGINE  -->
      <suki:SukiSideMenuItem
        x:Name="AudioEngineMenuItem"
        Classes="Compact"
        Header="{I18N {x:Static lang:SRKeys.Page_AudioEngine}}">
        <suki:SukiSideMenuItem.Icon>
          <materialIcons:MaterialIcon Kind="Speaker" />
        </suki:SukiSideMenuItem.Icon>
        <suki:SukiSideMenuItem.PageContent>
          <pages:AudioEnginePage />
        </suki:SukiSideMenuItem.PageContent>
      </suki:SukiSideMenuItem>

      <!--  PAGE 4: SETTINGS  -->
      <suki:SukiSideMenuItem
        x:Name="SettingsMenuItem"
        Classes="Compact"
        Header="{I18N {x:Static lang:SRKeys.Page_Settings}}">
        <suki:SukiSideMenuItem.Icon>
          <materialIcons:MaterialIcon Kind="Cog" />
        </suki:SukiSideMenuItem.Icon>
        <suki:SukiSideMenuItem.PageContent>
          <pages:SettingsPage />
        </suki:SukiSideMenuItem.PageContent>
      </suki:SukiSideMenuItem>

    </suki:SukiSideMenu.Items>

    <!--  HEADER LOGO  -->
    <suki:SukiSideMenu.HeaderContent>
      <StackPanel Margin="0,20,0,20" HorizontalAlignment="Center">
        <Panel Width="80" Height="80">
          <Panel.Styles>
            <Style Selector="Button">
              <Setter Property="Transitions">
                <Setter.Value>
                  <Transitions>
                    <BrushTransition Property="Background" Duration="{DynamicResource ShortAnimationDuration}" />
                  </Transitions>
                </Setter.Value>
              </Setter>
            </Style>
            <Style Selector="Path">
              <Setter Property="Transitions">
                <Setter.Value>
                  <Transitions>
                    <BrushTransition Property="Fill" Duration="{DynamicResource ShortAnimationDuration}" />
                  </Transitions>
                </Setter.Value>
              </Setter>
            </Style>
          </Panel.Styles>
          <Border Background="#181C1F" CornerRadius="20" />
          <Border
            Background="{DynamicResource SukiPrimaryColor10}"
            CornerRadius="20"
            RenderOptions.BitmapBlendingMode="Screen" />
        <Panel
            Margin="10,0,10,15">
          <Border
            Background="#2A2F33"
            CornerRadius="15" />
          <Border
            Background="{DynamicResource SukiPrimaryColor10}"
            CornerRadius="15"
            RenderOptions.BitmapBlendingMode="Screen">
          
          </Border>
          <Viewbox
            Width="36"
            Height="36" RenderTransform="scale(1,1.05)" Margin="0,3,0,0"
            ClipToBounds="False">
            <Panel>
              <Path
                Data="M413.589333 577.472h-150.784c-19.690667 0-33.28-19.712-26.261333-38.101333L386.346667 146.090667A28.096 28.096 0 0 1 412.586667 128h252.864c19.946667 0 33.536 20.202667 26.005333 38.677333l-87.253333 214.144h164.266666c24.149333 0 37.034667 28.48 21.098667 46.634667L386.922667 886.293333c-19.584 22.293333-55.893333 2.965333-48.277334-25.728l74.944-283.093333z"
                Fill="{DynamicResource SukiPrimaryColor75}"
                RenderOptions.BitmapBlendingMode="Screen"
                Stretch="Uniform">
              </Path>
              <Path
                Data="M413.589333 577.472h-150.784c-19.690667 0-33.28-19.712-26.261333-38.101333L386.346667 146.090667A28.096 28.096 0 0 1 412.586667 128h252.864c19.946667 0 33.536 20.202667 26.005333 38.677333l-87.253333 214.144h164.266666c24.149333 0 37.034667 28.48 21.098667 46.634667L386.922667 886.293333c-19.584 22.293333-55.893333 2.965333-48.277334-25.728l74.944-283.093333z"
                Fill="White" Opacity="0.3"
                Stretch="Uniform">
              </Path>
            </Panel>
          </Viewbox>
        </Panel>
       
        </Panel>

        <TextBlock
          HorizontalAlignment="Center"
          Classes="h4"
          FontWeight="SemiBold"
          Text="KeyASIO" />
        <TextBlock HorizontalAlignment="Center" Opacity="0.5">
          <Run Text="v" /><Run Text="{Binding UpdateService.Version}" />
        </TextBlock>
      </StackPanel>
    </suki:SukiSideMenu.HeaderContent>

    <!--  FOOTER VOLUME  -->
    <suki:SukiSideMenu.FooterContent>
      <StackPanel Margin="15,10">
        <Separator Margin="0,0,0,10" Classes="Section" />

        <Grid ColumnDefinitions="Auto,*,Auto,Auto">
          <!--  MASTER VOLUME (Quick Access)  -->
          <materialIcons:MaterialIcon
            Width="17"
            Height="17"
            Margin="0,0,7,0"
            Kind="VolumeHigh"
            Opacity="0.8"
            ToolTip.Tip="{I18N {x:Static lang:SRKeys.Volume_Master}}" />
          <Slider
            Grid.Column="1"
            VerticalAlignment="Center"
            Maximum="{Binding AppSettings.Audio.EnableExtendedVolume, Converter={StaticResource ExtendedVolumeConverter}}"
            PointerWheelChanged="Slider_PointerWheelChanged"
            Value="{Binding AppSettings.Audio.MasterVolume}" />
          <TextBlock
            Grid.Column="2"
            Width="35"
            Margin="2,0,0,0"
            VerticalAlignment="Center"
            FontSize="12"
            Text="{Binding AppSettings.Audio.MasterVolume, StringFormat='{}{0}%'}"
            TextAlignment="Right" />

          <!--  MIXER BUTTON  -->
          <Button
            Grid.Column="3"
            Margin="5,0,0,0"
            Padding="6"
            Classes="Basic"
            Cursor="Hand"
            ToolTip.Tip="{I18N {x:Static lang:SRKeys.Page_AudioEngine}}">
            <materialIcons:MaterialIcon
              Width="17"
              Height="17"
              Kind="Tune" />
            <Button.Flyout>
              <Flyout Placement="Top">
                <controls:VolumeMixerControl />
              </Flyout>
            </Button.Flyout>
          </Button>
        </Grid>
      </StackPanel>
    </suki:SukiSideMenu.FooterContent>
  </suki:SukiSideMenu>
</suki:SukiWindow>